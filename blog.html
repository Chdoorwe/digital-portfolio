<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Archives</title>

    <link rel="stylesheet" href="resorsis/css/blog.css">
    <link rel="stylesheet" href="resorsis/css/light_mode.css">
    <link rel="stylesheet" href="resorsis/css/search_bar.css">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">


</head>

<body>

    <div id="searchWrapper">
        <div id="tagContainer"></div>
        <input type="text" id="blogSearch" placeholder="Search by ID or tag">
        <div id="tagDropdown"></div>
    </div>


    <!-- Readability Toggle Button -->
    <button id="readability-toggle">Toggle Readability</button>

    <header>
        <h1><a href="index.html">Archives</a></h1>
    </header>

    <main>
        <div id="special">all is not what its seems <a href="projects.html">here</a> the bass of the tree of
            life "hello"</div>

        <section class="LA-container ">
            <ul class="Blog-post-list">

                <!-- POST 1 -->
                <li class="blog-post" id="spider-opal" data-tags="lost_archives">
                    <section>
                        <h2><a href="resorsis/html/blogs/lost-archives/spider-opal.html">Spider Opal</a></h2>
                        <p>
                            (lost archives) <br>
                            At first glance, the Spider Opal is breathtaking a rounded gem laced with delicate, web‑like
                            veins that shimmer in the light. But beauty hides terror. The crystalline webs grow,
                            consume,
                            and transform anything they touch. Those who study it whisper of Opal Spiders crawling
                            within, and of voices that call from the chamber, urging entry… urging surrender.</p>
                    </section>
                </li>

                <!-- POST 2 -->
                <li class="blog-post" id="story-one" data-tags="bermuda">
                    <section>
                        <h2><a href="resorsis/html/blogs/bermuda/jhon/story-one.html">Story One <br>The Sea Of
                                Avaritias</a></h2>
                        <p>(bermuda)
                            summary coming soon
                        </p>
                    </section>
                </li>

                <li class="blog-post" id="story-one" data-tags="argone">
                    <section>
                        <h2><a href="resorsis/html/blogs/argone/hollowed-god.html">The Hollowed God</a></h2>
                        <p>(argone)
                            summary coming soon
                        </p>
                    </section>
                </li>



            </ul>
        </section>
    </main>

    <footer>
        © Copyright 2025
    </footer>

    <script>
        // Show special message sometimes
        window.onload = function () {
            const chance = 0.25;
            if (Math.random() < chance) {
                document.getElementById("special").style.display = "block";
            }
        };

        // Apply saved readability mode
        if (localStorage.getItem("readable") === "true") {
            document.body.classList.add("readable-mode");
        }

        // Toggle button logic
        const toggleBtn = document.getElementById("readability-toggle");
        toggleBtn.addEventListener("click", () => {
            document.body.classList.toggle("readable-mode");
            localStorage.setItem("readable", document.body.classList.contains("readable-mode"));
        });
    </script>

    <!-- SEARCH + TAG DROPDOWN -->
    <script>
        const searchInput = document.getElementById("blogSearch");
        const tagContainer = document.getElementById("tagContainer");
        const dropdown = document.getElementById("tagDropdown");
        const posts = document.querySelectorAll(".blog-post");

        let activeTags = [];

        /* ---------------------------
           COLLECT ALL TAGS
        ---------------------------- */
        const allTags = new Set();
        posts.forEach(post => {
            const tags = post.dataset.tags?.split(",") || [];
            tags.forEach(t => allTags.add(t.trim()));
        });

        /* ---------------------------
           CREATE TAG BUBBLE
        ---------------------------- */
        function addTagBubble(tag) {
            if (activeTags.includes(tag)) return;

            activeTags.push(tag);

            const bubble = document.createElement("div");
            bubble.className = "tag-bubble";
            bubble.innerHTML = `${tag} <span>x</span>`;

            bubble.querySelector("span").onclick = () => {
                bubble.remove();
                activeTags = activeTags.filter(t => t !== tag);
                runSearch();
            };

            tagContainer.appendChild(bubble);
            searchInput.value = "";
            runSearch();
        }

        /* ---------------------------
           UPDATE DROPDOWN
        ---------------------------- */
        function updateDropdown(filter = "") {
            dropdown.innerHTML = "";
            const filtered = [...allTags].filter(tag =>
                tag.toLowerCase().includes(filter.toLowerCase())
            );

            if (filtered.length === 0) {
                dropdown.style.display = "none";
                return;
            }

            filtered.forEach(tag => {
                const div = document.createElement("div");
                div.className = "tag-option";
                div.textContent = tag;
                div.onclick = () => {
                    addTagBubble(tag);
                    dropdown.style.display = "none";
                };
                dropdown.appendChild(div);
            });

            dropdown.style.display = "block";
        }

        /* ---------------------------
           ANIMATED HIDE
        ---------------------------- */
        function hidePost(post) {
            if (post.classList.contains("hidden") || post.classList.contains("hiding")) return;

            post.classList.add("hiding");
            setTimeout(() => {
                post.classList.add("hidden");
                post.classList.remove("hiding");
            }, 350);
        }

        /* ---------------------------
           ANIMATED SHOW
        ---------------------------- */
        function showPost(post) {
            if (!post.classList.contains("hidden")) return;

            post.classList.remove("hidden");
            void post.offsetWidth;
            post.classList.add("hiding");
            requestAnimationFrame(() => {
                post.classList.remove("hiding");
            });
        }

        /* ---------------------------
           MAIN SEARCH FUNCTION
        ---------------------------- */
        function runSearch() {
            const textSearch = searchInput.value.toLowerCase();

            posts.forEach(post => {
                const id = (post.id || "").toLowerCase();
                const tags = (post.dataset.tags || "").toLowerCase();

                const matchesText = textSearch && (id.includes(textSearch) || tags.includes(textSearch));
                const matchesTags = activeTags.some(t => tags.includes(t));

                if (matchesText || matchesTags || (!textSearch && activeTags.length === 0)) {
                    showPost(post);
                } else {
                    hidePost(post);
                }
            });
        }

        /* ---------------------------
           INPUT EVENTS
        ---------------------------- */
        searchInput.addEventListener("input", () => {
            updateDropdown(searchInput.value);
            runSearch();
        });

        searchInput.addEventListener("keydown", (e) => {
            if (e.key === "Enter" && searchInput.value.trim() !== "") {
                addTagBubble(searchInput.value.trim());
                dropdown.style.display = "none";
            }
        });

        searchInput.addEventListener("focus", () => {
            updateDropdown(searchInput.value);
        });

        document.addEventListener("click", (e) => {
            if (!searchInput.contains(e.target)) dropdown.style.display = "none";
        });
    </script>



</body>

</html>